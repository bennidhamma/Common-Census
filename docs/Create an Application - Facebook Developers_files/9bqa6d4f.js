/*
HTTP Host: static.ak.fbcdn.net
Generated: June 8th 2010 6:10:59 PM PDT
Machine: 10.16.139.103
Locale: nu_ll
Path: js/72lger2d9rwgog04.pkg.js
*/

if (window.CavalryLogger) { CavalryLogger.start_js(["js\/72lger2d9rwgog04.pkg.js"]); }

Book&&Book.at('eval');JX.$A=function(b){var c=[];for(var a=0;a<b.length;a++)c.push(b[a]);return c;};JX.$AX=function(a){return (a instanceof Array)?a:[a];};JX.copy=function(a,b){for(var c in b)a[c]=b[c];return a;};JX.bind=function(b,c,d){var a=JX.$A(arguments).slice(2);return function(){return c.apply(b||window,a.concat(JX.$A(arguments)));};};JX.bag=function(){};JX.keys=function(b){var c=[];for(var a in b)c.push(a);return c;};JX.defer=function(a,c){var b=setTimeout(a,c||0);return {stop:function(){clearTimeout(b);}};};JX.go=function(a){(a&&(window.location=a))||window.location.reload(true);};
JX.install=function(h,g){if(typeof JX.install._a=='undefined')JX.install._a=0;if(h in JX)return;if(!JX.install._b)JX.install._b=[];JX.install._b.push([h,g]);do{var d;var f=null;for(var c=0;c<JX.install._b.length;++c){d=JX.install._b[c][1];if(d.extend&&!JX[d.extend])continue;f=JX.install._b[c][0];JX.install._b.splice(c,1);--c;JX[f]=function(){this.__id__='__obj__'+(++JX.install._a);return (d.construct||JX.bag).apply(this,arguments);};JX.copy(JX[f],d.statics);var k;if(d.extend){k=JX[f].prototype=new JX[d.extend]();}else k=JX[f].prototype={};k.__class__=JX[f];for(var e in (d.properties||{})){var b=e.charAt(0).toUpperCase()+e.substr(1);var j='__auto__'+e;k[j]=d.properties[e];k['set'+b]=(function(l){return function(m){this[l]=m;return this;};})(j);k['get'+b]=(function(l){return function(){return this[l];};})(j);}JX.copy(k,d.members);if(d.events&&d.events.length){var i=JX[d.extend]||{};JX[f].__name__='class:'+f;var a=i.__path__||[];JX[f].__path__=a.concat([JX[f].__name__]);k.invoke=function(l){return JX.Stratcom.invoke('obj:'+l,this.__class__.__path__.concat([this.__id__]),{args:JX.$A(arguments).slice(1)});};k.listen=function(m,l){return JX.Stratcom.listen('obj:'+m,this.__id__,JX.bind(this,function(n){return l.apply(this,n.getData().args);}));};JX[f].listen=function(m,l){return JX.Stratcom.listen('obj:'+m,this.__name__,JX.bind(this,function(n){return l.apply(this,n.getData().args);}));};}(d.initialize||JX.bag)();}}while(f);};
JX.install('Event',{members:{stop:function(){var a=this.getRawEvent();if(a){a.cancelBubble=true;a.stopPropagation&&a.stopPropagation();}this.setStopped(true);return this;},prevent:function(){var a=this.getRawEvent();if(a){a.returnValue=false;a.preventDefault&&a.preventDefault();}this.setPrevented(true);return this;},kill:function(){this.prevent();this.stop();return this;},getSpecialKey:function(){var b=this.getRawEvent();if(!b||b.shiftKey)return null;var a=b.keyCode;do{a=JX.Event._a[a]||null;}while(a&&JX.Event._a[a]);return a;}},statics:{_a:{8:'delete',9:'tab',13:'return',27:'esc',37:'left',38:'up',39:'right',40:'down',63232:38,63233:40,62234:37,62235:39}},properties:{rawEvent:null,type:null,target:null,data:null,path:[],stopped:false,prevented:false,nodes:{}},initialize:function(){}});
JX.install('Stratcom',{statics:{ready:false,_a:{},_b:[],_c:{},_d:/\bFN_([^ ]+)/,_e:/\bFD_([^ ]+)/,_f:'*',_g:{},_h:[],_i:9000,invoke:function(d,b,a){var c=new JX.Event().setType(d).setData(a||{}).setPath(b||[]);return this._j(c);},listen:function(k,h,a){var c=[];k=JX.$AX(k);if(!h)h=this._f;if(!(h instanceof Array))h=[[h]];if(!(h[0] instanceof Array))h=[h];for(var d=0;d<k.length;++d){var i=k[d];if(!(i in this._a))this._a[i]={};var j=this._a[i];for(var e=0;e<h.length;++e){var g=h[e];var b=this._b.length;this._b.push(a);this._c[b]=g.length;c.push(b);for(var f=0;f<g.length;++f){if(!j[g[f]])j[g[f]]=[];j[g[f]].push(b);}}}return {remove:function(){for(var l=0;l<c.length;l++)delete JX.Stratcom._b[c[l]];}};},dispatch:function(event){try{var target=event.srcElement||event.target;if(target===window||(!target||target.nodeName=='#document'))target={nodeName:'window'};}catch(k){var target=null;}var f=[];var e=[];var b={};var a=target;while(a){var c=a.className||'';var j;j=(c.match(this._d)||[])[1];if(j){b[j]=this.getData(a);e[j]=a;f.push(j);}if(a.id){j='id:'+a.id;b[j]=a;f.push(j);}a=a.parentNode;}if(target){var h='tag:'+target.nodeName.toLowerCase();f.push(h);b[h]=null;}var d=event.type;var i={focusin:'focus',focusout:'blur'};if(d in i)d=i[d];var g=new JX.Event().setRawEvent(event).setType(d).setTarget(target).setData(b).setNodes(e).setPath(f.reverse());return this._j(g);},_j:function(i){var k=this._a[i.getType()];if(!k)return i;var h=i.getPath();var f=h.length;var c={};var g;for(var j=-1;j<f;++j){if(j==-1){g=k[this._f];}else g=k[h[j]];if(!g)continue;for(var d=0;d<g.length;++d)c[g[d]]=(c[g[d]]||0)+1;}var a=[];for(var e in c)if(c[e]==this._c[e]){var b=this._b[e];if(!b)continue;a.push(b);}this._h.push({handlers:a,event:i,cursor:0});this.pass();this._h.pop();return i;},pass:function(){var a=this._h[this._h.length-1];while(a.cursor<a.handlers.length){var b=a.cursor;++a.cursor;(a.handlers[b]||JX.bag)(a.event);if(a.event.getStopped())break;}return a.event.getStopped()||a.event.getPrevented();},context:function(){if(!this._h.length)return null;return this._h[this._h.length-1].event;},mergeData:function(a){JX.copy(this._g,a);JX.Stratcom.ready=true;JX.__rawEventQueue({type:'start-queue'});},sigilize:function(c,d,b){var a=[c.className];if(b){this._g[this._i]=b;a.push('FD_'+(this._i++));}a.push('FN_'+d);c.className=a.reverse().join(' ');},hasSigil:function(a,b){return (a.className.match(this._d)||[])[1]==b;},getData:function(b){var a=((b.className||'').match(this._e)||[])[1];return (a&&this._g[a])||{};}}});
JX.install('Base',{members:{invoke:function(b,a){},listen:function(b,a){}},statics:{listen:function(b,a){}}});
JX.install('Boot',{statics:{_a:null,_b:[],_c:{},_d:{},_e:{},load:function(e,a){var b=this._b.length;this._b.push(a);var d=0;for(var c in e){if(c in this._e)continue;if(e[c].type=='js'){if(!this._d[e[c].name])this._d[e[c].name]={};this._d[e[c].name][b]=true;d++;}}this._c[b]=d;if(!this._c[b])this._f(b);for(var c in e){if(c in this._e)continue;this.loadRawResource(e[c].type,e[c].name);}},loadRawResource:function(c,b){var a;switch(c){case 'js':a=document.createElement('script');a.type='text/javascript';a.src=b;break;case 'css':a=document.createElement('link');a.rel="stylesheet";a.type="text/css";a.media="all";a.href=b;break;}this._g().appendChild(a);},done:function(b){for(var a in (this._d[b]||{}))if(!--this._d[b][k]){delete this._d[b][k];this._f(a);}},_f:function(a){setTimeout(this._b[a],0);delete this._c[a];delete this._b[a];},_g:function(){if(!this._a){var b,a=document.getElementsByTagName('head');if(a.length){b=a[0];}else b=document.body;this._a=b;}return this._a;}}});
JX.install('$V',{construct:function(a,b){if(this==JX||this==window)return new JX.$V(a,b);if(typeof b=='undefined')return JX.$V.getPos(a);this.x=parseFloat(a);this.y=parseFloat(b);},members:{x:null,y:null,setPos:function(a){a.style.left=(this.x===null)?'':(parseInt(this.x,10)+'px');a.style.top=(this.y===null)?'':(parseInt(this.y,10)+'px');return this;},setDim:function(a){a.style.width=(this.x===null)?'':(parseInt(this.x,10)+'px');a.style.height=(this.y===null)?'':(parseInt(this.y,10)+'px');return this;},add:function(a,b){if(a instanceof JX.$V)return this.add(a.x,a.y);return JX.$V(this.x+parseFloat(a),this.y+parseFloat(b));}},statics:{_a:null,getPos:function(b){JX.Event&&(b instanceof JX.Event)&&(b=b.getRawEvent());if(('pageX' in b)||('clientX' in b)){var a=JX.$V._a;return JX.$V(b.pageX||(b.clientX+a.scrollLeft),b.pageY||(b.clientY+a.scrollTop));}var c=b.offsetLeft;var d=b.offsetTop;while(b.offsetParent&&(b.offsetParent!=document.body)){b=b.offsetParent;c+=b.offsetLeft;d+=b.offsetTop;}return JX.$V(c,d);},getDim:function(a){return JX.$V(a.offsetWidth,a.offsetHeight);},getScroll:function(){var a=document.body;var b=document.documentElement;return JX.$V(a.scrollLeft||b.scrollLeft,a.scrollTop||b.scrollTop);},getViewport:function(){var a=JX.$V._a;var b=window;return JX.$V(b.innerWidth||a.clientWidth||0,b.innerHeight||a.clientHeight||0);},getDocument:function(){var a=JX.$V._a;return JX.$V(a.scrollWidth||0,a.scrollHeight||0);}},initialize:function(){var a=((a=document)&&(a=a.documentElement))||((a=document)&&(a=a.body));JX.$V._a=a;}});
JX.$=function(a){var b=document.getElementById(a);if(!b||(b.id!=a))throw JX.$.NotFound;return b;};JX.$.NotFound={};JX.install('HTML',{construct:function(a){if(this==JX||this==window)return new JX.HTML(a);this._a=a;},members:{_a:null,getFragment:function(){var b=JX.$N('div');b.innerHTML=this._a;var a=document.createDocumentFragment();while(b.firstChild)a.appendChild(b.removeChild(b.firstChild));return a;}}});JX.$N=function(d,a,b){if(typeof b=='undefined'&&(typeof a!='object'||a instanceof JX.HTML)){b=a;a={};}var c=document.createElement(d);if(a.style){JX.copy(c.style,a.style);delete a.style;}if(a.sigil){JX.Stratcom.sigilize(c,a.sigil,a.meta);delete a.sigil;delete a.meta;}JX.copy(c,a);if(b)JX.DOM.setContent(c,b);return c;};JX.install('DOM',{statics:{_b:0,_c:{},_d:{},setContent:function(b,a){while(b.firstChild)JX.DOM.remove(b.firstChild);JX.DOM.appendContent(b,a);},prependContent:function(b,a){this._e(b,a,this._f);},appendContent:function(b,a){this._e(b,a,this._g);},_f:function(b,a){b.insertBefore(a,b.firstChild);},_g:function(b,a){b.appendChild(a);},_e:function(e,b,d){if(b===null||typeof b=='undefined')return;if(b instanceof JX.HTML)b=b.getFragment();if(b instanceof Array){for(var c=0;c<b.length;c++){var a=(typeof b[c]=='string')?document.createTextNode(b[c]):b[c];d(e,a);}}else if(b.nodeType){d(e,b);}else d(e,document.createTextNode(b));},remove:function(a){a.parentNode&&JX.DOM.replace(a,null);return a;},replace:function(b,d){var a;if(b.nextSibling){a=JX.bind(b.nextSibling,function(f,e){f.insertBefore(e,this);});}else a=this._g;var c=b.parentNode;b.parentNode.removeChild(b);this._e(c,d,a);return b;},serialize:function(c){var b=c.getElementsByTagName('*');var a={};for(var d=0;d<b.length;++d){if(!b[d].name)continue;var f=b[d].type;var e=b[d].tagName;if((f in {radio:1,checkbox:1}&&b[d].checked)||f in {text:1,hidden:1,password:1}||e in {TEXTAREA:1,SELECT:1})a[b[d].name]=b[d].value;}return a;},isNode:function(a){return !!(a&&a.nodeName&&(a!==window));},isType:function(b,c){b=(''+b.nodeName||'').toUpperCase();c=JX.$AX(c);for(var a=0;a<c.length;++a)if(c[a].toUpperCase()==b)return true;return false;},listen:function(b,d,c,a){return JX.Stratcom.listen(d,['id:'+JX.DOM.uniqID(b)].concat(JX.$AX(c||[])),a);},uniqID:function(a){if(!a.id)a.id='autoid_'+(++JX.DOM._b);return a.id;},alterClass:function(d,b,a){var c=((' '+d.className+' ').indexOf(' '+b+' ')>-1);if(a&&!c){d.className+=' '+b;}else if(c&&!a)d.className=d.className.replace(new RegExp('(^|\\s)'+b+'(?:\\s|$)','g'),' ');},htmlize:function(a){return (''+a).replace(/&/g,'&amp;').replace(/"/g,'&quot;').replace(/</g,'&lt;').replace(/>/g,'&gt;');},show:function(){for(var a=0;a<arguments.length;++a)arguments[a].style.display='';},hide:function(){for(var a=0;a<arguments.length;++a)arguments[a].style.display='none';},textMetrics:function(c,e,f){if(!this._c[e]){var b=JX.$N('var',{className:e});this._c[e]=b;}var d=this._c[e];document.body.appendChild(d);d.style.width=f?(f+'px'):'';JX.DOM.setContent(d,JX.HTML(JX.DOM.htmlize(c.value).replace(/\n/g,'<br />')));var a=JX.$V.getDim(d);document.body.removeChild(d);return a;},scry:function(d,f,e){var b=d.getElementsByTagName(f);if(!e)return JX.$A(b);var c=[];for(var a=0;a<b.length;a++)if(JX.Stratcom.hasSigil(b[a],e))c.push(b[a]);return c;},find:function(b,d,c){var a=JX.DOM.scry(b,d,c);if(!a.length)throw JX.$.NotFound;return a[0];},bindController:function(e,d,a){var b=JX.DOM.uniqID(e);var c=(this._d[d]=(this._d[d]||{}));return (c[b]=(c[b]||(a())));},focus:function(b){try{b.focus();}catch(a){}}}});
JX.install('FX',{statics:{_a:0,_b:null,showBlind:function(){if(!this._a){this._b=JX.$N('div',{className:'LFXBlind'});document.body.appendChild(this._b);JX.$V.getDim(document.body).setDim(this._b);}++this._a;},hideBlind:function(){--this._a;if(!this._a){JX.DOM.remove(this._b);this._b=null;}}}});JX.install('Progressbar',{construct:function(c,a,d,b){this._c=c;this._d=a;this._d.style.width='0';this._e=d;this._f=b;this._g=JX.DOM.listen(this._c,'click',['cancel','tag:button'],JX.bind(this,this._h));JX.DOM.show(this._c);},members:{_i:0,_e:0,_d:null,_c:null,_g:null,_f:null,update:function(){++this._i;this._j();},set:function(a){this._i=a;this._e=1;this._j();},end:function(){if(this._e===null)return;JX.DOM.hide(this._c);},_j:function(){if(this._e===null)return;var a=parseInt(100*this._i/this._e,10);this._d.style.width=a+'%';},_h:function(){this._g.remove();this.end();this._e=null;(this._f||JX.bag)();}}});
JX.install('Flash',{construct:function(c,a,b){JX.copy(this,{_a:{},_b:{wmode:'transparent'},_c:{},_d:JX.$(a)});var d=JX.$V.getDim(this._d);this.setAttributes({classid:'clsid:D27CDB6E-AE6D-11cf-96B8-444553540000',type:JX.Flash._e,data:c,width:d.x,height:d.y,id:b});},statics:{_e:'application/x-shockwave-flash'},members:{setAttributes:function(a){JX.copy(this._a,a);return this;},setVariables:function(a){JX.copy(this._c,a);return this;},setParameters:function(a){JX.copy(this._b,a);return this;},_f:function(){var b=[];for(var a in this._c)b.push(encodeURIComponent(a)+'='+encodeURIComponent(this._c[a]));if(b.length)this._b.flashvars=b.join('&');return this._b;},_g:function(){var b=this._a;var e=this._f();e.movie=b.data;delete b.data;delete b.type;var a=[];for(var c in b)a.push(JX.DOM.htmlize(c)+'="'+JX.DOM.htmlize(b[c])+'"');a=a.join(' ');var d=[];for(var c in e)d.push('<param name="'+JX.DOM.htmlize(c)+'" value="'+JX.DOM.htmlize(e[c])+'" />');d=d.join("\n");return '<object '+a+'>'+d+'</object>';},_h:function(){var b=JX.$N('object',this._a);var c=this._f();for(var a in c)b.appendChild(JX.$N('param',{name:a,value:c[a]}));return b;},render:function(){if(document.attachEvent){this._d.innerHTML=this._g();}else JX.DOM.setContent(this._d,this._h());}}});
JX.install('JSON',{statics:{serialize:function(a){return JX.JSON._a(a);},_a:function(d){var c=[];if(d.push&&d.pop){for(var a=0;a<d.length;a++)c.push(JX.JSON._a(d[a]));return '['+c.join(',')+']';}else if(d===null){return 'null';}else if(d===true){return 'true';}else if(d===false){return 'false';}else if(typeof d=='string'){return JX.JSON._b(d);}else if(typeof d=='number'){return d;}else{for(var b in d)c.push(JX.JSON._b(b)+':'+JX.JSON._a(d[b]));return '{'+c.join(',')+'}';}},_b:function(a){return '"'+a.replace(/\\/g,'\\\\').replace(/"/g,'\\"')+'"';}}});
JX.behavior=function(b,a){JX.behavior._a[b]=a;};JX.initBehaviors=function(c){for(var d in c){var a=c[d];if(!a.length)if(d in JX.behavior._b){continue;}else a=[null];for(var b=0;b<a.length;b++)JX.behavior._a[d](a[b]);JX.behavior._b[d]=true;}};!function(a){a.behavior._a={};a.behavior._b={};}(JX);
JX.install('Request',{construct:function(b,a){this.setURI(b);if(a)this.listen('done',a);},events:['done','error','finally'],members:{_a:null,_b:null,_c:false,send:function(){var f=null;try{try{f=new XMLHttpRequest();}catch(e){f=new ActiveXObject("Msxml2.XMLHTTP");}}catch(e){f=new ActiveXObject("Microsoft.XMLHTTP");}this._b=f;this._a=JX.Request._d.length;JX.Request._d.push(this);f.onreadystatechange=JX.bind(this,this._e);var c=[];var a=this.getData()||{};a.__async__=true;for(var b in a)c.push(encodeURIComponent(b)+'='+encodeURIComponent(a[b]));c=c.join('&');var d=this.getURI();if(this.getMethod()=='GET')d+=((d.indexOf('?')===-1)?'?':'&')+c;f.open(this.getMethod(),d,true);if(this.getMethod()=='POST'){f.setRequestHeader('Content-Type','application/x-www-form-urlencoded');f.send(c);}else f.send(null);},abort:function(){this._c=true;this._b.abort();delete JX.Request._d[this._a];},_e:function(){var xport=this._b;try{if(this._c)return;if(xport.readyState!=4)return;if(xport.status<200&&xport.status>=300){this._f();return;}var text=xport.responseText.substring('for (;;);'.length);var response=eval('('+text+')');}catch(exception){this._f();return;}try{if(response.error){this._f(response.error);}else{JX.Stratcom.mergeData(response.javelin_metadata||{});this._g(response);JX.initBehaviors(response.javelin_behaviors||{});}}catch(exception){JX.defer(function(){throw exception;});}},_f:function(a){this.invoke('error',a);delete JX.Request._d[this._a];this.invoke('finally');},_g:function(b){if(b.onload)for(var a=0;a<b.onload.length;a++)(new Function(b.onload[a]))();this.invoke('done',this.getRaw()?b:b.payload);delete JX.Request._d[this._a];this.invoke('finally');}},statics:{_d:[],shutdown:function(){for(var a=0;a<JX.Request._d.length;a++)try{JX.Request._d[a]&&JX.Request._d[a].abort();}catch(b){}JX.Request._d=[];}},properties:{URI:null,data:null,method:'POST',raw:false},initialize:function(){JX.Stratcom.listen('unload','tag:window',JX.Request.shutdown);}});
JX.install('Pipeline',{statics:{_a:0,_b:{},_c:null,_d:false,start:function(a){JX.Stratcom.listen('focus','tag:window',JX.Pipeline.resume);JX.Stratcom.listen('blur','tag:window',JX.Pipeline.pause);JX.Pipeline._b=a||{};JX.defer(JX.Pipeline._e,10000);},addRequest:function(event,a){JX.Pipeline._b[event]=a;},_e:function(){if(JX.Pipeline._d)return;JX.Pipeline._a++;var a={requests:JX.JSON.serialize(JX.Pipeline._b),count:JX.Pipeline._a};JX.Pipeline._c=new JX.Request('/@/',JX.Pipeline._f).setData(a);JX.Pipeline._c.send();},_f:function(d){JX.Pipeline._c=null;var a=d.events;var c=Math.max(1000,d.interval*1000);for(var b=0;b<a.length;b++)JX.Stratcom.invoke(a[b].event,a[b].path,a[b].data);JX.defer(JX.Pipeline._e,c);},resume:function(a){if(!JX.Pipeline._c)JX.Pipeline._e();JX.Pipeline._d=false;},pause:function(a){if(JX.Pipeline._c){JX.Pipeline._c.abort();JX.Pipeline._c=null;}JX.Pipeline._d=true;}}});
JX.install('Workflow',{construct:function(b,a){this.setURI(b);this.setData(a||{});},events:['error','finally','submit'],statics:{_a:[],newFromForm:function(b,a){var d=[].concat(JX.DOM.scry(b,'input'),JX.DOM.scry(b,'button'),JX.DOM.scry(b,'textarea'));for(var c=0;c<d.length;c++)if(d[c].disabled){delete d[c];}else d[c].disabled=true;var e=new JX.Workflow(b.getAttribute('action'),JX.copy(a||{},JX.DOM.serialize(b)));e.listen('finally',function(){for(var f=0;f<d.length;f++)d[f]&&(d[f].disabled=false);});return e;},newFromLink:function(a){return new JX.Workflow(a.href);},_b:function(a){JX.FX.showBlind();JX.Workflow._a.push(a);},_c:function(){var a=JX.Workflow._a.pop();(a.getCloseHandler()||JX.bag)();a._d();JX.FX.hideBlind();},disable:function(){JX.Workflow._e=true;},_f:function(event){if(JX.Workflow._e)return;var e=event.getTarget();if(e.name=='__cancel__'||e.name=='__close__'){JX.Workflow._c();}else{var d=event.getNodes().LDialog;var b=JX.DOM.serialize(d);b[e.name]=true;var a=JX.Workflow._a[JX.Workflow._a.length-1];var c=a.invoke('submit',{form:d,data:b});if(!c.getStopped()){a._d();a.setURI(d.getAttribute('action')||a.getURI()).setData(b).start();}}event.prevent();}},members:{_g:null,_h:false,_i:function(c){if(c.redirect){JX.go(c.redirect,true);}else if(c.dialog){this._b();this._g=JX.$N('div',{className:'LJSDialog'},JX.HTML(c.dialog));JX.DOM.listen(this._g,'click','tag:button',JX.Workflow._f);document.body.appendChild(this._g);var b=JX.$V.getDim(this._g);var e=JX.$V.getViewport();var d=JX.$V.getScroll();JX.$V((e.x-b.x)/2,d.y+100).setPos(this._g);try{JX.DOM.focus(JX.DOM.find(this._g,'button','__default__'));var inputs=JX.DOM.scry(this._g,'input').concat(JX.DOM.scry(this._g,'textarea'));var miny=Number.POSITIVE_INFINITY;var target=null;for(var ii=0;ii<inputs.length;++ii)if(inputs[ii].type!='hidden'){var p=JX.$V(inputs[ii]);if(p.y<miny){miny=p.y;target=inputs[ii];}}target&&JX.DOM.focus(target);}catch(a){}}else if(this.getHandler()){this.getHandler()(c);this._c();}},_b:function(){if(!this._h){this._h=true;JX.Workflow._b(this);}},_c:function(){if(this._h){this._h=false;JX.Workflow._c();}},_d:function(){if(this._g){JX.DOM.remove(this._g);this._g=null;}},start:function(){var b=this.getURI();var a=new JX.Request(b,JX.bind(this,this._i));a.setData(this.getData());a.listen('finally',JX.bind(this,this.invoke,'finally'));a.listen('error',JX.bind(this,function(d){var c=this.invoke('error',d);if(c.getStopped())return;if(!JX.Stratcom.pass())JX.go(b.match(/^(https?:\/\/[^\/]+)?\/?w\//)?'/error/':b,true);}));a.send();}},properties:{handler:null,closeHandler:null,data:null,URI:null},initialize:function(){JX.Stratcom.listen('keydown',null,function(c){if(c.getSpecialKey()!='esc'||JX.Workflow._e||JX.Stratcom.pass())return;var a=JX.Workflow._a[JX.Workflow._a.length-1];if(!a)return;var e=[];var b=JX.DOM.scry(a._g,'button');for(var d=0;d<b.length;d++)if(JX.Stratcom.hasSigil(b[d],'__cancel__')||b[d].name&&b[d].name=='__close__')e.push(e[d]);if(e.length){JX.Workflow._c();c.prevent();}});}});
JX.behavior('attach-photo',function(a){JX.Stratcom.listen('submit','attach-photo',function(b){var c=b.getTarget();if(c.id!=a.form)return;var d,f=JX.DOM.uniqID(JX.$N('a'));try{d=document.createElement('<iframe name="'+f+'">');}catch(h){d=JX.$N('iframe');d.name=f;}d.style.position='absolute';d.style.left='-50000px';d.src='about:blank';document.body.appendChild(d);c.target=f;var g=JX.$N('input',{type:'hidden',name:'__jsonp__',value:d.name});c.appendChild(g);var e=JX.Stratcom.listen('jsonp-response',null,function(j){var i=j.getData();if(i.jsonp!=d.name)return;e.remove();j.kill();JX.DOM.remove(d);c.reset();var k=JX.$N('img');k.onload=function(){JX.FX.hideBlind();};k.src=i.uri;JX.$(a.image).src=i.uri;});JX.defer(function(){JX.FX.showBlind();c.submit();JX.DOM.remove(g);});b.prevent();});});
JX.behavior('chat-popout',function(a){JX.Stratcom.listen('click','quack',function(b){var c='fbChatWindow';var d='status=0,toolbar=0,location=0,menubar=0,directories=0,'+'resizable=1,scrollbars=0,width=700,height=500,left=30,'+'top=30';var e=window.open('',c,d);if(e.location.href.indexOf(a.uri)==-1)e.location=a.uri;e.focus();b.prevent();JX.Stratcom.invoke('channel-popout');});});
JX.behavior('ci-add-contact',function(a){function b(e,c){for(var d=0;d<e.length;d++)if(e[d].type=='checkbox')e[d].checked=c;}JX.Stratcom.listen('click','friend-select',function(d){var c=d.getNodes()['friend-select'].checked;var e=JX.DOM.scry(d.getNodes()['friend-form'],'input','ci-friendable');b(e,c);});JX.Stratcom.listen('click','invite-select',function(d){var c=d.getNodes()['invite-select'].checked;var e=JX.DOM.scry(d.getNodes()['invite-form'],'input','ci-invitable');b(e,c);});JX.Stratcom.listen('click','friend-skip',function(c){if(!a)return;c.prevent();var d=c.getNodes()['friend-form'];var e=JX.DOM.find(d.parentNode,'form','invite-form');JX.DOM.hide(d);JX.DOM.show(e);});JX.Stratcom.listen('submit','friend-form',function(c){if(!a)return;c.prevent();var d=c.getNodes()['friend-form'];console.log(d);var e=JX.DOM.find(d.parentNode,'form','invite-form');JX.DOM.hide(d);JX.DOM.show(e);JX.Workflow.newFromForm(d).setHandler(function(f){}).start();});JX.Stratcom.listen('submit','invite-form',function(c){c.prevent();var d=c.getNodes()['invite-form'];JX.Workflow.newFromForm(d).start();});});
JX.behavior('ci-check-api',function(e){var i=null;var c=null;function f(o){var p=o+"=";var m=document.cookie.split(';');for(var n=0;n<m.length;n++){var l=m[n];while(l.charAt(0)==' ')l=l.substring(1,l.length);if(l.indexOf(p)==0)return decodeURIComponent(l.substring(p.length,l.length));}return null;}function k(l,m){document.cookie=l+"="+encodeURIComponent(m)+"; path=/; domain=."+window.location.hostname.replace(/^.*(facebook\..*)$/i,'$1');}function b(l,n){var m=null;var o=f('fb_api_auth_token');if(o&&o.substr(0,1)==l)m=o.substr(2);if(m){n.api_instance.value=l;n.auth_token.value=m;n.submit();}else this.cookieTimer=setTimeout(JX.bind(this,b,l,n),500);}function h(l,m){if(f('fb_api_auth_token'))k('fb_api_auth_token','');if(this.cookieTimer)clearTimeout(this.cookieTimer);b(l,m);}function d(l){if(this.keypressTimer)clearTimeout(this.keypressTimer);this.keypressTimer=setTimeout(JX.bind(this,j,l),300);}function j(l){if(this.keypressTimer)clearTimeout(this.keypressTimer);a(l);this.keypressTimer=setTimeout(JX.bind(this,j,l),1000);}function a(n){var m=n.email.value;var l=m.split('@')[1];if(e[l]){JX.DOM.hide(JX.DOM.find(n,'tr','ci-password'));}else JX.DOM.show(JX.DOM.find(n,'tr','ci-password'));}function g(l,n){var m=n.email.value;var t=600;var o=400;if(l==2){o=500;}else if(l==3)o=450;var p=((screen.width-t)/2);var q=((screen.height-o)/2);var r='status=0,toolbar=0,location=1,resizable=1,scrollbars=1,alwaysRaised=1,'+'width='+t+',height='+o+',left='+p+',top='+q;var s='/find-friends/api/auth/?api_instance='+l+'&email='+encodeURIComponent(m);window.open(s,'api_import',r);h(l,n);}JX.Stratcom.listen('click','ci-api-auth',function(m){m.prevent();var l=m.getData()['ci-api-auth'].api_instance;var n=m.getNodes()['ci-form'];g(l,n);});JX.Stratcom.listen('keydown','ci-login',function(l){var m=l.getNodes()['ci-form'];d(m);});JX.Stratcom.listen('blur','ci-login',function(l){var m=l.getNodes()['ci-form'];a(m);});JX.Stratcom.listen('submit','ci-form',function(n){var p=n.getNodes()['ci-form'];var o=p.email.value;var m=o.split('@')[1];var l=e[m];if(l&&!p.auth_token.value){n.prevent();g(l,p);}});});
JX.behavior('event-create',function(){var b={};function a(e,d,f){var g=e['start_'+d].value;if(f)g=(parseInt(g)+f)+"";if(typeof(b[d])=='undefined'){b[d]=g;JX.enableDispatch(e['start_'+d],'change');JX.DOM.listen(e['start_'+d],'change',null,JX.bind(this,a,e,d,f));return;}var c=e['end_'+d].value;if(b[d]!=g&&b[d]==c){e['end_'+d].value=g;b[d]=g;}}JX.Stratcom.listen(['click','keypress','focus'],'event-start',function(c){var d=c.getNodes()['event-edit'];JX.defer(function(){a(d,'month');a(d,'day');a(d,'year');a(d,'time',60);});});});
(function(){JX.Stratcom.listen(['focus','blur'],[['ufi_container','tag:textarea'],['fancy-text-area','tag:textarea']],function(a){var b=a.getTarget();if(a.getType()=='focus'){b.style.height='6em';}else if(!b.value.match(/\S/))b.style.height='';});})();
JX.behavior('feed-update',function(){JX.Stratcom.listen('pipeline-feed',null,function(b){var a=b.getData();JX.Pipeline.addRequest('pipeline-feed',{newest:a.newest});JX.DOM.prependContent(JX.$('home_stream'),JX.HTML(a.content));});});
JX.behavior('friend-requests',function(a){JX.Stratcom.listen('click',['friend-requests','confirm-ignore-request'],function(b){b.prevent();var c=b.getNodes()['friend-requests'];c.parentNode.removeChild(c);var d=b.getNodes()['confirm-ignore-request'];JX.Workflow.newFromLink(d).start();});});
JX.install('Typeahead',{construct:function(a,b){if(b){this._a=b.hardpoint;this._b=b.control;}else{var d=JX.$(a.root);this._a=JX.DOM.find(d,'div','typeahead-hardpoint');this._b=JX.DOM.find(d,'input');}if(a.disableOnChoose==false)this._c=false;this._d=JX.$N('div',{className:'LTypeaheadResults'});JX.DOM.listen(this._b,['focus','blur','keypress','keydown'],null,JX.bind(this,this.handleEvent));JX.DOM.listen(this._d,['mouseover','mouseout'],null,JX.bind(this,this._e));JX.DOM.listen(this._d,'mousedown','tag:a',JX.bind(this,function(e){this._f(e.getTarget());e.prevent();}));var c=new JX.Request(a.src,JX.bind(this,this._g));c.setMethod('GET');c.send();},events:['reveal','choose','query'],properties:{allowNullSelection:true,ignoreBlur:false,normalizer:null},members:{_d:null,_b:null,_a:null,_h:null,_i:false,_j:false,_k:-1,_l:null,_m:null,_n:[],_c:true,show:function(){if(!this.invoke('reveal',this._d).getPrevented()){var a=JX.$V.getDim(this._a);a.x=0;a.setPos(this._d);this._a.appendChild(this._d);}},hide:function(){this._o(Number.NEGATIVE_INFINITY);this._n=[];JX.DOM.setContent(this._d,'');JX.DOM.remove(this._d);},_e:function(event){this._p=(event.getType()=='mouseover');this._q();},_o:function(a){var b=Math.min(Math.max(-1,this._k+a),this._n.length-1);if(!this.getAllowNullSelection())b=Math.max(0,b);if(this._k>=0&&this._k<this._n.length)JX.DOM.alterClass(this._n[this._k],'focused',0);this._k=b;this._q();return true;},_q:function(){var a=this._n[this._k];if(a)JX.DOM.alterClass(a,'focused',!this._p);},_f:function(b){var a=this.invoke('choose',b);if(a.getPrevented())return;this._b.value=b.name;this.hide();this._b.blur();this._j=true;if(this._c)this._b.disabled=true;},clear:function(){this._b.value='';this.hide();},submit:function(){if(this._k>=0&&this._n[this._k]){this._f(this._n[this._k]);return true;}else{result=this.invoke('query',this._b.value);if(result.getPrevented())return true;}return false;},update:function(event){var a=event&&event.getSpecialKey();if(a&&event.getType()=='keydown')switch(a){case 'up':if(this._n.length&&this._o(-1))event.prevent();break;case 'down':if(this._n.length&&this._o(1))event.prevent();break;case 'return':if(this.submit())event.prevent();break;case 'esc':if(this._n.length&&this.getAllowNullSelection()){this.hide();event.prevent();}break;}setTimeout(JX.bind(this,this.redraw),0);},redraw:function(){if(!this._i||this._j)return;var r=this._r(this._b.value);if(this._h==r)return;this._h=r;var i={};var j={};var l={};var p={};var q=this.tokenize(this._h);q.sort(function(s,t){return t.length-s.length;});for(var d=0;d<q.length;++d){if(q[d] in p){q.splice(d--,1);continue;}p[q[d]]=true;var b=new RegExp('^'+q[d]);for(var n in this._l)if(n.match(b)){if(!(n in l)){l[n]=true;}else continue;var h=this._l[n];for(var e=0;e<h.length;++e){var k=h[e];if(!j[k])j[k]={};if(!(b in j[k])){j[k][b]=true;i[k]=(i[k]||0)+1;}}}}var c=[];for(var f in i)if(i[f]==q.length)c.push(f);c.sort(function(s,t){return s-t;});var m=Math.min(5,c.length);var o=[];for(var g=0;g<m;g++){var a=this._m[c[g]];o.push(JX.$N('a',{href:a[1],name:a[0],rel:a[2]},a[0]));}this._n=o;if(o.length){JX.DOM.setContent(this._d,o);this._o(Number.NEGATIVE_INFINITY);this.show();}else this.hide();},_g:function(c){this._m=c;this._l={};for(var a=0;a<c.length;++a){var d=this.tokenize(c[a][0]);for(var b=0;b<d.length;++b){this._l[d[b]]=this._l[d[b]]||[];this._l[d[b]].push(a);}}this._i=true;this.update();},handleEvent:function(a){if(this._j||a.getPrevented())return;var b=a.getType();if(b=='blur'){if(!this.getIgnoreBlur())this.hide();}else this.update(a);},tokenize:function(a){var a=this._r(a).replace(/^\s*|\s*$/g,'');if(!a.length)return [];return a.split(/ /g);},_r:function(b){var a=this.getNormalizer();return a?a(b):JX.Typeahead.normalize(b);}},statics:{_s:{'\u00e0':'a','\u00e1':'a','\u00e2':'a','\u00e3':'a','\u00e4':'a','\u00e5':'a','\u00e6':'ae','\u00e7':'c','\u00e8':'e','\u00e9':'e','\u00ea':'e','\u00eb':'e','\u00ec':'i','\u00ed':'i','\u00ee':'i','\u00ef':'i','\u00f0':'d','\u00f1':'n','\u00f2':'o','\u00f3':'o','\u00f4':'o','\u00f5':'o','\u00f6':'o','\u00f8':'o','\u00f9':'u','\u00fa':'u','\u00fb':'u','\u00fc':'u','\u00fd':'y','\u00ff':'y','\u0153':'oe','\u0430':'a','\u0431':'b','\u0432':'v','\u0433':'g','\u0434':'d','\u0435':'e','\u0437':'z','\u0438':'i','\u0439':'j','\u043a':'k','\u043b':'l','\u043c':'m','\u043d':'n','\u043e':'o','\u043f':'p','\u0440':'r','\u0441':'s','\u0442':'t','\u0443':'u','\u0444':'f','\u0445':'h','\u0446':'c','\u0447':'ch','\u0448':'sh','\u044b':'y','\u044d':'e','\u044e':'u','\u044f':'ya'},normalize:function(b){var a=JX.Typeahead._s;return (''+b).toLowerCase().replace(/[\u00e0-\u0450]/g,function(c){return (c in a?a[c]:c);}).replace(/[^a-z ]/g,'').replace(/ +/g,' ');}}});
JX.install('Tokenizer',{construct:function(a){var c=JX.$(a.root);this._a=JX.DOM.find(c,'input','tokenizer');this._b=[];this._c={};this._d=a.next&&JX.$(a.next);this._e=a.limit||null;var b=JX.$N('input',{className:'LTokenizerInput',type:'text',value:this._a.value});this._f=b;JX.DOM.listen(b,['click','focus','blur','keydown'],null,JX.bind(this,this.handleEvent));JX.DOM.listen(c,['click'],null,JX.bind(this,function(d){if(d.getNodes().remove){this._g(d.getData().token);}else if(d.getTarget()==c)this.focus();}));var c=JX.$N('div');c.id=this._a.id;JX.DOM.alterClass(c,'LTokenizer',true);this._h=c;c.appendChild(b);this._i=new JX.Typeahead(a,{hardpoint:this._h,control:this._f});this._i.setAllowNullSelection(false);this._i.listen('choose',JX.bind(this,function(d){JX.Stratcom.context().prevent();if(this.addToken(d.rel,d.name)){this._i.hide();this._f.value='';this._j();this.focus();}}));this._i.listen('query',JX.bind(this,function(f){if(!a.email)return;var d=f.split(/[,; ]/);var g=false;for(var e=0;e<d.length;++e){d[e]=d[e].replace(/^\s+|\s+$/g,'');if(d[e].match(/.*@.*\.[a-z]+$/))g=g||this.addToken(d[e],d[e]);}if(g){this._f.value='';this._j();this.focus();JX.Stratcom.context().prevent();}}));JX.defer(JX.bind(this,function(){JX.DOM.setContent(this._a.parentNode,c);var e=a.value||{};for(var d in e)this.addToken(d,e[d]);this._j();}));},members:{_h:null,_f:null,_a:null,_i:null,_k:0,_b:null,_c:null,_l:0,_d:null,_m:null,handleEvent:function(a){this._i.handleEvent(a);if(a.getPrevented())return;if(a.getType()=='click'){if(a.getTarget()==this._h){this.focus();a.prevent();return;}}else if(a.getType()=='keydown'){this._n(a);}else if(a.getType()=='blur')this._j();},_j:function(){var a=this._f;if(a.value===this._m)return;this._m=a.value;var d=this._h;var c=JX.DOM.textMetrics(this._f,'LTokenizerMetrics');c.y=null;c.x+=24;c.setDim(a);a.value=a.value;var b=JX.$V(a).add(JX.$V.getDim(a)).y-JX.$V(d).y;d.style.height=b+'px';},addToken:function(c,g){if(c in this._c)return false;var a=this._f;var e=this._h;var f=JX.$N('a',{className:'LTokenizerToken'},g);var b=JX.$N('input',{type:'hidden',value:c,name:this._a.name+'['+(this._l++)+']'});var d=JX.$N('a',{className:'LTokenizerX'},JX.HTML('&times;'));this._c[c]={value:g,key:c,node:f};this._b.push(c);JX.Stratcom.sigilize(f,'token',c);JX.Stratcom.sigilize(d,'remove');f.appendChild(b);f.appendChild(d);e.insertBefore(f,a);return true;},_n:function(b){var c=this._f;var d=this._h;switch(b.getSpecialKey()){case 'return':b.prevent();break;case 'tab':var a=this._i.submit();if(this._d){if(!a)this._f.value='';JX.defer(JX.bind(this,function(){this._d.focus();}));}break;case 'delete':if(!this._f.value.length){var e;while(e=this._b.pop())if(this._g(e))break;}break;default:if(this._e&&JX.keys(this._c).length==this._e)b.prevent();JX.defer(JX.bind(this,this._j));break;}},_g:function(a){if(!this._c[a])return false;JX.DOM.remove(this._c[a].node);delete this._c[a];this._j();this.focus();return true;},focus:function(){var a=this._f;JX.DOM.show(a);JX.defer(function(){JX.DOM.focus(a);});}}});
JX.behavior('inbox-compose',function(a){var b=new JX.Tokenizer(a);if(a.value){JX.$(a.next).focus();}else b.focus();});
JX.behavior('inbox-reply',function(){JX.Stratcom.listen('submit','inbox-reply',function(a){a.prevent();var b=a.getTarget();var f=JX.DOM.find(b,'textarea');var c=a.getNodes();var e=c['stream-container'];var d=c['reply-form-container'];JX.Workflow.newFromForm(b).setHandler(function(g){e.removeChild(d);JX.DOM.appendContent(e,JX.HTML(g));e.appendChild(d);f.value='';JX.defer(function(){f.focus();});}).start();});});
JX.behavior('inbox-search',function(a){var b=new JX.Typeahead(a);b.listen('choose',function(c){JX.go(a.action+'?'+a.param+'='+c.rel);});});
JX.behavior('mobile-subscribers',function(b){var d=new JX.Typeahead(b);var e=JX.DOM.find(document,'table','subscribers');var a=0;d.listen('choose',function(f){JX.Stratcom.context().prevent();d.clear();try{var row=JX.$('remove-'+f.rel);try{var h=JX.DOM.find(row,'input');JX.DOM.remove(h);JX.DOM.show(row);}catch(g){}return;}catch(g){}try{JX.$('cancel-'+f.rel);return;}catch(g){}var h=JX.$N('input',{type:'hidden',value:f.rel,name:'add['+(a++)+']'});var m=JX.$N('tr',{id:'cancel-'+f.rel});var l=JX.$N('th');var i=JX.$N('a',{href:f.href});JX.DOM.appendContent(i,f.name);JX.DOM.appendContent(l,i);var k=JX.$N('td');var j=JX.$N('a',{href:'#',className:'remove'});JX.Stratcom.sigilize(j,'cancel-add',f.rel);JX.DOM.appendContent(j,JX.HTML('&times;'));JX.DOM.appendContent(k,[j,h]);JX.DOM.appendContent(m,[l,k]);e.appendChild(m);});var c=0;JX.Stratcom.listen('click','remove-subscriber',function(f){f.prevent();var g=f.getData()['remove-subscriber'];var i=JX.$('remove-'+g);var h=JX.$N('input',{type:'hidden',value:g,name:'rem['+(c++)+']'});JX.DOM.appendContent(i,h);JX.DOM.hide(i);});JX.Stratcom.listen('click','cancel-add',function(f){f.prevent();var g=f.getData()['cancel-add'];var h=JX.$('cancel-'+g);JX.DOM.remove(h);});});
JX.behavior('photo-legacy-upload',function(a){document.domain='facebook.com';JX.Stratcom.listen('photo-legacy-upload-complete',null,function(event){JX.go(a);});});
JX.behavior('publisher-write',function(){function a(c){var d=c.getNodes().publisher;if(!d)return;var e=JX.DOM.find(d,'div','write-view');var b=JX.DOM.find(d,'div','button-view');JX.DOM.hide(e);JX.DOM.show(b);}JX.Stratcom.listen('click','write-button',function(c){c.prevent();var d=c.getNodes().publisher;var e=JX.DOM.find(d,'div','write-view');var b=JX.DOM.find(d,'div','button-view');JX.DOM.show(e);JX.DOM.hide(b);JX.DOM.focus(JX.DOM.find(e,'textarea'));});JX.Stratcom.listen('submit','write-form',function(b){b.prevent();var c=b.getTarget();var d=JX.DOM.find(c,'textarea');if(!d.value.match(/\S/))return;new JX.Workflow.newFromForm(c).setHandler(function(e){JX.DOM.prependContent(JX.$('yonder_stream'),JX.HTML(e));d.value='';a(b);}).start();});JX.Stratcom.listen('blur','write-view',function(b){if(!JX.DOM.isType(b.getTarget(),'textarea'))return;if(!b.getTarget().value.match(/\S/))a(b);});});
JX.behavior('real-time-alerts',function(){JX.Stratcom.listen('pipeline-real-time-alerts',null,function(event){var a=JX.$('alertsContent');JX.DOM.setContent(a,JX.HTML(event.getData().content));JX.DOM.show(a.parentNode);});JX.Stratcom.listen('click',['alerts-close'],function(a){a.prevent();var b=JX.$('alertsContent');JX.DOM.hide(b.parentNode);new JX.Workflow('/rtalerts/close/').setHandler(function(){}).start();});});
JX.behavior('pymk-reject',function(){JX.Stratcom.listen('click',['pymk','reject'],function(c){c.prevent();var d=c.getNodes();var a=c.getData();delete a.pymk[a.reject];var b={visible:JX.keys(a.pymk).join(',')};new JX.Workflow(c.getTarget().href,b).setHandler(function(f){if(!JX.keys(f).length){JX.DOM.remove(d.suggestion);if(!JX.keys(a.pymk).length)JX.DOM.remove(d.pymk);}else for(var e in f){JX.DOM.replace(d.suggestion,JX.HTML(f[e]));a.pymk[e]=true;break;}JX.DOM.alterClass(d.pymkList.lastChild,'last',true);}).start();});});
JX.behavior('search-typeahead',function(a){var b=new JX.Typeahead(a);b.listen('choose',function(c){JX.go(c.href);});});
JX.behavior('settings-profile',function(a){JX.Stratcom.listen('click','profile_privacy',function(b){if(b.getTarget().value=='public'){JX.DOM.show(JX.$(a.contactID));}else JX.DOM.hide(JX.$(a.contactID));});JX.Stratcom.listen('click','custom_privacy',function(b){JX.$(b.getData().custom_privacy.radioID).checked='checked';JX.DOM.hide(JX.$(a.contactID));});});
JX.behavior('stream-story-delete',function(){JX.Stratcom.listen('click','story_remove',function(a){a.prevent();var b=a.getTarget();new JX.Workflow(a.getTarget().href).setHandler(function(){JX.DOM.remove(b.parentNode);}).start();});});
JX.install('Tagger',{construct:function(b){var c=b.getNodes().phideoroot;this._a=JX.DOM.find(c,'button','tag-action');this._b=JX.DOM.find(c,'div','tag-control');this._c=JX.DOM.find(c,'div','tag-list');this._d=JX.DOM.find(c,'input','tag-input');JX.Stratcom.listen('keydown',null,JX.bind(this,function(e){if(e.getSpecialKey()=='esc'&&this._e){this._f(false);e.kill();}}));var d=new JX.Typeahead(b.getData()['tag-action']);this._g=d;d.setAllowNullSelection(false);d.setIgnoreBlur(true);d.listen('choose',JX.bind(this,function(e){JX.Stratcom.context().prevent();this._h(e.rel,null);this._i();}));d.listen('query',JX.bind(this,function(e){JX.Stratcom.context().prevent();if(this._j){this._h(null,e);this._i();}}));this._k=JX.DOM.find(c,'button','tag-confirm');JX.DOM.listen(this._k,'click',null,function(e){d.submit();e.prevent();});var a=b.getData().phideoroot;this._l=a.uri;this._j=a.text;this._m={};},events:['enable','disable','clear','didRedraw','didHitCanvas'],members:{_e:false,_a:null,_b:null,_c:null,_n:null,_o:null,_l:null,_m:null,setCanvas:function(a){this._o=a;JX.DOM.listen(this._o,['mousedown','click'],null,JX.bind(this,function(b){if(this._e){this.invoke('didHitCanvas',b,this._o);b.prevent();}}));return this;},addData:function(a){JX.copy(this._m,a);return this;},handleEvent:function(b){this._g.handleEvent(b);if(b.getPrevented())return;var c=b.getNodes();var a=b.getData();var d=b.getType();if(c['tag-action'])if(d=='click'){this._f(!this._e);b.prevent();}},_f:function(a){if(this._e==a)return;this._e=a;JX.DOM.alterClass(this._a,'grey_active',a);if(this._e){JX.DOM.show(this._b);this.invoke('enable');JX.defer(JX.bind(this,function(){JX.DOM.focus(this._d);}));}else{this._d.blur();this._i();this.invoke('disable');JX.DOM.hide(this._b);}},_i:function(){this._d.value='';this._g.redraw();this.invoke('clear');},_h:function(b,c){var a=JX.copy(this._m,{subject:b,name:c});new JX.Workflow(this._l,a).setHandler(JX.bind(this,function(d){JX.DOM.setContent(this._c,JX.HTML(d));this.invoke('didRedraw');this._m={};})).start();}}});
JX.behavior('tag-photos',function(){JX.Stratcom.listen('click','tag-action',function(a){var b=a.getNodes().phideoroot;JX.DOM.bindController(b,'Tagger',function(){var f=new JX.Tagger(a);var d=JX.DOM.find(b,'div','tag-control');var e=JX.DOM.find(b,'div','tag-explain');var c=JX.DOM.find(b,'img','tag-canvas');document.body.appendChild(JX.DOM.remove(d));f.setCanvas(c);f.listen('enable',function(){JX.DOM.hide(JX.DOM.find(b,'div','tag-overlay'));JX.DOM.hide(d);JX.DOM.show(e);JX.DOM.alterClass(c,'tag-canvas',true);});f.listen('disable',function(){JX.DOM.hide(JX.DOM.find(b,'div','tag-overlay'));JX.DOM.hide(e);JX.DOM.alterClass(c,'tag-canvas',false);});f.listen('clear',function(){JX.DOM.hide(d);});f.listen('didRedraw',function(){JX.DOM.hide(JX.DOM.find(b,'div','tag-overlay'));});f.listen('didHitCanvas',function(i,g){var k=JX.$V(i);var l=k;l.x-=110;l.y+=20;l.setPos(d);var j=JX.$V(g);k.x-=j.x;k.y-=j.y;var h=JX.$V.getDim(g);f.addData({x:100*(k.x/h.x),y:100*(k.y/h.y)});JX.DOM.show(d);JX.defer(function(){JX.DOM.focus(JX.DOM.find(d,'input','tag-input'));});});return f;}).handleEvent(a);});});
JX.behavior('tag-video',function(){JX.Stratcom.listen('click','tag-action',function(a){JX.DOM.bindController(a.getNodes().phideoroot,'Tagger',function(){return new JX.Tagger(a);}).handleEvent(a);});});
JX.behavior('theme-collage',function(a){var d=a.length;var e=[];for(var b=0;b<a.length;b++){img=new Image();img.onload=function(){--d;if(!d)c();};img.src=a[b];e.push(img);}function c(){var k=JX.$V.getViewport();var f=0;var l=0;var m=0;var i=Number.POSITIVE_INFINITY;for(var h=0;h<e.length;h++)if(!e[h].height){e=e.splice(h--,1);continue;}else i=Math.min(i,e[h].height);while(l<k.x||m<k.y){var g=JX.$N('div');g.style.background='url('+e[f].src+')';g.style.width=e[f].width+'px';g.style.height=e[f].height+'px';g.style.position='fixed';g.style.left=l+'px';g.style.top=m+'px';document.body.insertBefore(g,document.body.firstChild);m+=e[f].height;if(m>k.y&&l<k.x){m=0;l+=e[f].width;e.sort(function(){return .5-Math.random();});}f=(f+1)%e.length;}var j=JX.$N('div');k.setDim(j);j.style.position='fixed';j.style.background='#ffffff';j.style.top='0px';j.style.opacity='0.75';document.body.appendChild(j);}});
JX.behavior('ufi-read-more',function(){JX.Stratcom.listen('click','read_more_snipped',function(a){a.prevent();var b=a.getNodes().read_more_snipped;JX.DOM.show(b.nextSibling);JX.DOM.hide(b);});});
JX.behavior('ufi',function(){function c(event){var j=event.getNodes();var h=event.getData().ufi_container;var g=h.args;var f;var i=null;if(j.comment_form){f='add_comment';i=event.getTarget();}else if(j.like){f='like';}else if(j.unlike){f='unlike';}else if(j.del_comment){f='del_comment';g.comment_id=event.getData().del_comment.comment_id;}else if(j.comment_link){a(h,j);JX.DOM.focus(JX.$(h.textarea));event.prevent();return;}else if(j.more_comments){f='more_comments';}else if(j.all_likes){f='all_likes';}else return;var k='/'+f+'/';if(!(f in {more_comments:1,all_likes:1}))k='/w/'+h.token+k;if(f in {like:1,unlike:1})d(f,j,h);var l;if(i){i.action=k;l=JX.Workflow.newFromForm(i,g);}else l=new JX.Workflow(k,g);l.setHandler(JX.bind(null,e,f,j)).start();event.prevent();}function e(f,h,i){var k=h.ufi_container;var g=JX.DOM.find(k,'div','all_comments');if(f in {add_comment:1,more_comments:1}){if(i.last_comment){JX.DOM.appendContent(g,JX.HTML(i.last_comment));}else if(i.all_comments)JX.DOM.setContent(g,JX.HTML(i.all_comments));var j=JX.DOM.find(k,'textarea');j.value='';j.style.height='';}else if(f=='del_comment')JX.DOM.remove(h.del_comment.parentNode);}function d(f,l,g){var m=l.ufi_container;var h=JX.DOM.find(m,'div','does_like');var i=JX.DOM.find(m,'div','does_not_like');var k=JX.DOM.find(m,'a','like');var n=JX.DOM.find(m,'a','unlike');var o=JX.DOM.find(m,'div','feedbackview');if(f=='like'){JX.DOM.show(h,n);JX.DOM.hide(i,k);a(g,l);}else{JX.DOM.hide(h,n);JX.DOM.show(k);if(g.other_likes_exist)JX.DOM.show(i);}var j=(f=='unlike'&&!g.other_likes_exist&&g.comment_count==0);JX.DOM.alterClass(o,'hide',j);}function a(g,i){if(b(g))return;var f='<table><tr>'+'<th><div>'+'<textarea name="comment" id="'+g.textarea+'"></textarea>'+'</div></th>'+'<td><button class="small" type="submit">Comment</button></td>'+'</tr></table>';var h=JX.$N('form',{method:'post'},JX.HTML(f));JX.Stratcom.sigilize(h,'comment_form',{});JX.DOM.alterClass(h,'comment',true);var j=JX.DOM.find(i.ufi_container,'div','feedbackview');j.appendChild(h);JX.DOM.alterClass(j,'hide',false);JX.DOM.alterClass(j,'noFeedback',true);}function b(f){try{var t=JX.$(f.textarea);}catch(g){if(g==JX.$.NotFound){return false;}else throw g;}return true;}JX.Stratcom.listen('click',['ufi_container','tag:a'],c);JX.Stratcom.listen(['submit'],['ufi_container','comment_form','tag:form'],c);});
JX.install('Heavy',{statics:{load:function(c,d,b,a){this._a.push(JX.$A(arguments));if(this._b)this._c();},configure:function(b,a){this._d();this._e=a;window.Env.post_form_id=b;this._c();},_a:[],_b:false,_e:null,_f:{},_d:function(){if(this._b)return;this._b=true;window.Env=window.Env||{};window.loaded=true;},_g:function(c,b,d){d&&d.update();if(!c.length){setTimeout(function(){d&&d.end();b[0]();},200);return;}var a=c.shift();window.Bootloader.loadComponents([a],JX.bind(JX.Heavy,JX.Heavy._g,c,b,d));},_c:function(){for(var a=0;a<this._a.length;a++)this._h.apply(this,this._a[a]);this._a=[];},_h:function(e,k,c,b){e=['bootloader','core'].concat(e);var a=b&&b[0]&&JX.$(b[0]);a&&JX.DOM.hide(a);var f=[function(){a&&JX.DOM.show(a);setTimeout(k,0);}];if(b)var j=new JX.Progressbar(JX.$(b[1]),JX.$(b[2]),e.length+1,function(){JX.DOM.show(a);f[0]=JX.bag;c();});var i=[];for(var g=0;g<e.length;++g)if(!(e[g] in this._f)){i.push(e[g]);this._f[e[g]]=true;}if(i.length){var d='enable='+i.join(',');if(!window.Bootloader)d+='&boot';JX.Boot.loadRawResource('js',this._e+'?'+d);}var h=setInterval(function(){if(!window.Bootloader)return;clearInterval(h);JX.Heavy._g(e,f,j);},50);}}});
(function(){var c=false;var b=false;var a=false;var d=null;JX.Stratcom.listen('click','upload-photos',function(e){e.prevent();if(b){if(!a)d.startUploader();return;}if(c)return;c=true;window.Env=window.Env||{};window.Env.pc=e.getData()['upload-photos'].config;window.env_get=function(f){return window.Env[f];};JX.Heavy.load(['dialog','photo-uploader-remote-js','fbplugin','UploaderProgress','lite-uploader-progress'],function(){(d=d||new UploaderRemote());d.setInitHandler(function(){window.Uploader.addDialogCloseListener(function(f){if(f)new JX.Workflow('/d/createalbum/').setHandler(function(g){LiteUploaderProgress.setAlbumURI(g.albumURI);window.Uploader.setAlbumID(g.albumLegacyID).setLite(true).startUpload();}).start();a=false;});}).setHandler(function(){a=true;}).setSource('lite');b=true;d.startUploader();},function(){c=false;},e.getData()['upload-photos'].bar);});})();
JX.behavior('video-upload',function(a){document.domain='facebook.com';JX.Stratcom.listen('video-select',null,function(event){var b=event.getData();var f=b.window;var d=b.input;var e=new JX.Progressbar(JX.$(a.rootID),JX.$(a.barID));var c=JX.$(a.frameID);c.style.position='absolute';c.style.left='-10000px';new JX.Workflow(a.createURI).setHandler(function(i){var g=JX.$N('iframe',{src:i.progressURI,style:{position:'absolute',left:'-10000px'}});var h={update_progress:function(j,m,k,l){e.set(parseInt(j)/parseInt(m));},too_big:function(){JX.log('too big omg ;o');}};window.VideoUploadProgress={getInstance:function(){return h;}};window.Arbiter={inform:JX.bind(JX.Stratcom,JX.Stratcom.invoke)};JX.Stratcom.listen('video_upload_done',null,function(j){e.set(1);JX.DOM.remove(g);JX.DOM.remove(c);var k=JX.$N('form');k.action=i.completeURI;k.method='POST';document.body.appendChild(k);k.submit();});document.body.appendChild(g);f.didCreateVideo(d,i.uploadURI);}).start();});});
JX.behavior('workflow',function(){JX.Stratcom.listen('submit',['workflow','tag:form'],function(a){if(JX.Stratcom.pass())return;if(a.getNodes().workflow!==a.getTarget())return;a.prevent();JX.Workflow.newFromForm(a.getTarget()).start();});JX.Stratcom.listen('click',['workflow','tag:a'],function(a){if(JX.Stratcom.pass())return;if(a.getNodes().workflow!==a.getTarget())return;a.prevent();JX.Workflow.newFromLink(a.getTarget()).start();});});

if (window.Bootloader) { Bootloader.done(["js\/72lger2d9rwgog04.pkg.js"]); }